---
notitle: 
---

@{
    var catchedPokemon = @Documents["Posts"].Select(x => x.Get("Number")).Distinct();
}

<h1 class="page-title">
    <div class="page-title__text">Table de capture</div>
    <div class="page-title__subtitle">Cible potentielle : <script type="text/javascript">randomizeNextTarget()</script></div>
</h1>

<ul class="pokemonlist">
    @{
        var groupedPokemons = (Documents["PokemonJson"].First().ToList().First().Value as System.Collections.Generic.List<dynamic>)
            .GroupBy(x => x.group);
    }

    @foreach(var pokemons in groupedPokemons)
    {
        <h1>@pokemons.Key (@pokemons.Count(x => catchedPokemon.Contains($"{x?.number ?? string.Empty}"))/@pokemons.Count())</h1>
        foreach(var pokemon in pokemons)
        {
            if(catchedPokemon.Contains($"{pokemon?.number ?? string.Empty}"))
            {
                var countForPokemon = @Documents["Posts"].OrderBy(x => x.Get("Date").ToString()).Count(x => x.Get("Number").ToString() == pokemon.number.ToString());
                var post = @Documents["Posts"].OrderBy(x => x.Get("Date").ToString()).First(x => x.Get("Number").ToString() == pokemon.number.ToString());
                <li class="@(countForPokemon > 1 ? "multiple-shiny" : "catched")"><a title="@pokemon.name" href="@Context.GetLink(post)">@pokemon.number.ToString().PadLeft(4, ' ')</a></li>
            }
            else
            {
                <li>@pokemon.number.ToString().PadLeft(4, ' ')</li>
            }
        }
    }
</ul>  